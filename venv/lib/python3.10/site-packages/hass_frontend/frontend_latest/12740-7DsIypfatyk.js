export const id=12740;export const ids=[12740];export const modules={55070:(e,t,r)=>{r.d(t,{Eu:()=>a,hZ:()=>n});const i=["#44739e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#f43600","#4ba93b","#5779bb","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function a(e){return i[e%i.length]}function n(e,t){return t.getPropertyValue(`--graph-color-${e+1}`)||a(e)}},42952:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var i=r(17463),a=r(34541),n=r(47838),o=r(68144),s=r(79932),d=r(5435),c=r(21780),h=e([d]);d=(h.then?(await h)():h)[0];(0,i.Z)([(0,s.Mo)("ha-relative-time")],(function(e,t){class r extends t{constructor(...t){super(...t),e(this)}}return{F:r,d:[{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"datetime",value:void 0},{kind:"field",decorators:[(0,s.Cb)({type:Boolean})],key:"capitalize",value:()=>!1},{kind:"field",key:"_interval",value:void 0},{kind:"method",key:"disconnectedCallback",value:function(){(0,a.Z)((0,n.Z)(r.prototype),"disconnectedCallback",this).call(this),this._clearInterval()}},{kind:"method",key:"connectedCallback",value:function(){(0,a.Z)((0,n.Z)(r.prototype),"connectedCallback",this).call(this),this.datetime&&this._startInterval()}},{kind:"method",key:"createRenderRoot",value:function(){return this}},{kind:"method",key:"firstUpdated",value:function(e){(0,a.Z)((0,n.Z)(r.prototype),"firstUpdated",this).call(this,e),this._updateRelative()}},{kind:"method",key:"update",value:function(e){(0,a.Z)((0,n.Z)(r.prototype),"update",this).call(this,e),this._updateRelative()}},{kind:"method",key:"_clearInterval",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=void 0)}},{kind:"method",key:"_startInterval",value:function(){this._clearInterval(),this._interval=window.setInterval((()=>this._updateRelative()),6e4)}},{kind:"method",key:"_updateRelative",value:function(){if(this.datetime){const e=(0,d.G)(new Date(this.datetime),this.hass.locale);this.innerHTML=this.capitalize?(0,c.f)(e):e}else this.innerHTML=this.hass.localize("ui.components.relative_time.never")}}]}}),o.fl);t()}catch(e){t(e)}}))},148:(e,t,r)=>{var i=r(17463),a=r(68144),n=r(79932),o=r(11654);r(52039);(0,i.Z)([(0,n.Mo)("ha-timeline")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({type:Boolean,reflect:!0})],key:"label",value:()=>!1},{kind:"field",decorators:[(0,n.Cb)({type:Boolean,reflect:!0})],key:"raised",value:()=>!1},{kind:"field",decorators:[(0,n.Cb)({reflect:!0,type:Boolean})],key:"notEnabled",value:()=>!1},{kind:"field",decorators:[(0,n.Cb)({type:Boolean})],key:"lastItem",value:()=>!1},{kind:"field",decorators:[(0,n.Cb)({type:String})],key:"icon",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"moreItems",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_showMore",value:()=>!1},{kind:"method",key:"render",value:function(){return a.dy` <div class="timeline-start"> ${this.label?"":a.dy` <ha-svg-icon .path="${this.icon||"M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}"></ha-svg-icon> `} ${this.lastItem?"":a.dy`<div class="line"></div>`} </div> <div class="content"> <slot></slot> ${this.moreItems?a.dy` <div> ${this._showMore||1===this.moreItems.length?this.moreItems:a.dy` <button class="link" @click="${this._handleShowMore}"> Show ${this.moreItems.length} more items </button> `} </div> `:""} </div> `}},{kind:"method",key:"_handleShowMore",value:function(){this._showMore=!0}},{kind:"get",static:!0,key:"styles",value:function(){return[a.iv`:host{display:flex;flex-direction:row}:host(:not([lastItem])){min-height:50px}:host([label]){margin-top:-8px;font-style:italic;color:var(--timeline-label-color,var(--secondary-text-color))}.timeline-start{display:flex;flex-direction:column;align-items:center;margin-right:8px;width:24px}:host([notEnabled]) ha-svg-icon{opacity:.5}ha-svg-icon{color:var(--timeline-ball-color,var(--timeline-color,var(--secondary-text-color)));border-radius:50%}:host([raised]) ha-svg-icon{transform:scale(1.3)}.line{flex:1;width:2px;background-color:var(--timeline-line-color,var(--timeline-color,var(--secondary-text-color)));margin:4px 0}.content{margin-top:2px}:host(:not([lastItem])) .content{padding-bottom:16px}:host([label]) .content{margin-top:0;padding-top:6px}`,o.k1]}}]}}),a.oi)},71955:(e,t,r)=>{var i=r(17463),a=r(77426),n=r(68144),o=r(79932);r(40789),r(10983);(0,i.Z)([(0,o.Mo)("ha-trace-blueprint-config")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"trace",value:void 0},{kind:"method",key:"render",value:function(){return n.dy` <ha-code-editor .value="${(0,a.$w)(this.trace.blueprint_inputs||"").trimRight()}" readOnly="readOnly" dir="ltr"></ha-code-editor> `}}]}}),n.oi)},13126:(e,t,r)=>{var i=r(17463),a=r(77426),n=r(68144),o=r(79932);r(40789),r(10983);(0,i.Z)([(0,o.Mo)("ha-trace-config")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"trace",value:void 0},{kind:"method",key:"render",value:function(){return n.dy` <ha-code-editor .value="${(0,a.$w)(this.trace.config).trimRight()}" readOnly="readOnly" dir="ltr"></ha-code-editor> `}},{kind:"get",static:!0,key:"styles",value:function(){return[n.iv``]}}]}}),n.oi)},8420:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var i=r(17463),a=r(68144),n=r(79932),o=(r(5588),r(44198)),s=e([o]);o=(s.then?(await s)():s)[0];(0,i.Z)([(0,n.Mo)("ha-trace-logbook")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.Cb)({type:Boolean,reflect:!0})],key:"narrow",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"method",key:"render",value:function(){return this.logbookEntries.length?a.dy` <ha-logbook-renderer relative-time .hass="${this.hass}" .entries="${this.logbookEntries}" .narrow="${this.narrow}"></ha-logbook-renderer> <hat-logbook-note .domain="${this.trace.domain}"></hat-logbook-note> `:a.dy`<div class="padded-box"> No Logbook entries found for this step. </div>`}},{kind:"get",static:!0,key:"styles",value:function(){return[a.iv`.padded-box{padding:16px}`]}}]}}),a.oi);t()}catch(e){t(e)}}))},78940:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var i=r(17463),a=r(77426),n=r(68144),o=r(79932),s=r(83448),d=r(44583),c=(r(40789),r(10983),r(5588),r(97389)),h=r(44198),l=r(19476),u=e([d,h]);[d,h]=u.then?(await u)():u;(0,i.Z)([(0,o.Mo)("ha-trace-path-details")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.Cb)({type:Boolean,reflect:!0})],key:"narrow",value:void 0},{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"selected",value:void 0},{kind:"field",decorators:[(0,o.Cb)()],key:"renderedNodes",value:()=>({})},{kind:"field",decorators:[(0,o.Cb)()],key:"trackedNodes",value:void 0},{kind:"field",decorators:[(0,o.SB)()],key:"_view",value:()=>"config"},{kind:"method",key:"render",value:function(){return n.dy` <div class="padded-box trace-info"> ${this._renderSelectedTraceInfo()} </div> <div class="tabs top"> ${[["config","Step Config"],["changed_variables","Changed Variables"],["logbook","Related logbook entries"]].map((([e,t])=>n.dy` <button .view="${e}" class="${(0,s.$)({active:this._view===e})}" @click="${this._showTab}"> ${t} </button> `))} </div> ${"config"===this._view?this._renderSelectedConfig():"changed_variables"===this._view?this._renderChangedVars():this._renderLogbook()} `}},{kind:"method",key:"_renderSelectedTraceInfo",value:function(){var e;const t=this.trace.trace;if(null===(e=this.selected)||void 0===e||!e.path)return"Select a node on the left for more information.";const r=this.selected.path.split("/");if("default"===r[r.length-1]){var i,o;const e=t[r.slice(0,r.length-1).join("/")];if(e&&"default"===(null===(i=e[0])||void 0===i||null===(o=i.result)||void 0===o?void 0:o.choice))return"The default action was executed because no options matched."}if(!(this.selected.path in t))return"This node was not executed and so no further trace information is available.";const s=[];let c=!1;for(const e of Object.keys(this.trace.trace)){if(c){if(e in this.renderedNodes)break}else{if(e!==this.selected.path)continue;c=!0}const r=t[e];s.push(r.map(((t,i)=>{const{path:o,timestamp:s,result:c,error:h,changed_variables:l,...u}=t;return!1===(null==c?void 0:c.enabled)?n.dy`This node was disabled and skipped during execution so no further trace information is available.`:n.dy` ${e===this.selected.path?"":n.dy`<h2>${e.substr(this.selected.path.length+1)}</h2>`} ${1===r.length?"":n.dy`<h3>Iteration ${i+1}</h3>`} Executed: ${(0,d.E8)(new Date(s),this.hass.locale,this.hass.config)}<br> ${c?n.dy`Result: <pre>${(0,a.$w)(c)}</pre>`:h?n.dy`<div class="error">Error: ${h}</div>`:""} ${0===Object.keys(u).length?"":n.dy`<pre>${(0,a.$w)(u)}</pre>`} `})))}return s}},{kind:"method",key:"_renderSelectedConfig",value:function(){var e;if(null===(e=this.selected)||void 0===e||!e.path)return"";const t=(0,c.nV)(this.trace.config,this.selected.path);return t?n.dy`<ha-code-editor .value="${(0,a.$w)(t).trimRight()}" readOnly="readOnly" dir="ltr"></ha-code-editor>`:"Unable to find config"}},{kind:"method",key:"_renderChangedVars",value:function(){const e=this.trace.trace[this.selected.path];return n.dy` <div class="padded-box"> ${e.map(((e,t)=>n.dy` ${t>0?n.dy`<p>Iteration ${t+1}</p>`:""} ${0===Object.keys(e.changed_variables||{}).length?"No variables changed":n.dy`<pre>${(0,a.$w)(e.changed_variables).trimRight()}</pre>`} `))} </div> `}},{kind:"method",key:"_renderLogbook",value:function(){const e=this.trace.trace,t=e[this.selected.path],r=Object.keys(this.trackedNodes),i=r.indexOf(this.selected.path);if(-1===i)return n.dy`<div class="padded-box">Node not tracked.</div>`;let a;if(i===r.length-1){const e=new Date(t[0].timestamp),r=this.logbookEntries.findIndex((t=>new Date(1e3*t.when)>=e));a=-1===r?[]:this.logbookEntries.slice(r)}else{const n=e[r[i+1]],o=new Date(t[0].timestamp),s=new Date(n[0].timestamp);a=[];for(const e of this.logbookEntries||[]){const t=new Date(1e3*e.when);if(t>=o){if(!(t<s))break;a.push(e)}}}return a.length?n.dy` <ha-logbook-renderer relative-time .hass="${this.hass}" .entries="${a}" .narrow="${this.narrow}"></ha-logbook-renderer> <hat-logbook-note .domain="${this.trace.domain}"></hat-logbook-note> `:n.dy`<div class="padded-box"> No Logbook entries found for this step. </div>`}},{kind:"method",key:"_showTab",value:function(e){this._view=e.target.view}},{kind:"get",static:!0,key:"styles",value:function(){return[l.b,n.iv`.padded-box{margin:16px}:host(:not([narrow])) .trace-info{min-height:250px}pre{margin:0}.error{color:var(--error-color)}`]}}]}}),n.oi);t()}catch(e){t(e)}}))},7719:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var i=r(17463),a=r(68144),n=r(79932),o=(r(5588),r(11777)),s=e([o]);o=(s.then?(await s)():s)[0];(0,i.Z)([(0,n.Mo)("ha-trace-timeline")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"selected",value:void 0},{kind:"method",key:"render",value:function(){return a.dy` <hat-trace-timeline .hass="${this.hass}" .trace="${this.trace}" .logbookEntries="${this.logbookEntries}" .selectedPath="${this.selected.path}" allowPick> </hat-trace-timeline> <hat-logbook-note .domain="${this.trace.domain}"></hat-logbook-note> `}},{kind:"get",static:!0,key:"styles",value:function(){return[a.iv`:host{display:block;padding:16px}`]}}]}}),a.oi);t()}catch(e){t(e)}}))},5588:(e,t,r)=>{var i=r(17463),a=r(68144),n=r(79932);(0,i.Z)([(0,n.Mo)("hat-logbook-note")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.Cb)()],key:"domain",value:()=>"automation"},{kind:"method",key:"render",value:function(){return a.dy` Not all shown logbook entries might be related to this ${this.domain}. `}},{kind:"field",static:!0,key:"styles",value:()=>a.iv`:host{display:block;text-align:center;font-style:italic;padding:16px;margin-top:8px}`}]}}),a.oi)},30946:(e,t,r)=>{var i=r(17463),a=r(34541),n=r(47838),o=r(68144),s=r(79932),d=r(47181),c=r(76680),h=(r(10983),r(83448));const l=10,u=30;(0,i.Z)([(0,s.Mo)("hat-graph-branch")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,s.Cb)({reflect:!0,type:Boolean})],key:"disabled",value:void 0},{kind:"field",decorators:[(0,s.Cb)({type:Boolean})],key:"selected",value:void 0},{kind:"field",decorators:[(0,s.Cb)({type:Boolean})],key:"start",value:()=>!1},{kind:"field",decorators:[(0,s.Cb)({type:Boolean})],key:"short",value:()=>!1},{kind:"field",decorators:[(0,s.SB)()],key:"_branches",value:()=>[]},{kind:"field",key:"_totalWidth",value:()=>0},{kind:"field",key:"_maxHeight",value:()=>0},{kind:"method",key:"_updateBranches",value:function(e){let t=0;const r=[],i=[];e.target.assignedElements().forEach((e=>{const a=e.clientWidth,n=e.clientHeight;i.push({x:a/2+t,height:n,start:e.hasAttribute("graphStart"),end:e.hasAttribute("graphEnd"),track:e.hasAttribute("track")}),t+=a,r.push(n)})),this._totalWidth=t,this._maxHeight=Math.max(...r),this._branches=i.sort(((e,t)=>e.track&&!t.track?1:e.track&&t.track?0:-1))}},{kind:"method",key:"render",value:function(){return o.dy` <slot name="head"></slot> ${this.start?"":o.YP` <svg id="top" width="${this._totalWidth}"> ${this._branches.map((e=>e.start?"":o.YP` <path class="${(0,h.$)({track:e.track})}" d="
                      M ${this._totalWidth/2} 0
                      L ${e.x} ${20}
                      "/> `))} </svg> `} <div id="branches"> <svg id="lines" width="${this._totalWidth}" height="${this._maxHeight}"> ${this._branches.map((e=>e.end?"":o.YP` <path class="${(0,h.$)({track:e.track})}" d="
                        M ${e.x} ${e.height}
                        v ${this._maxHeight-e.height}
                        "/> `))} </svg> <slot @slotchange="${this._updateBranches}"></slot> </div> ${this.short?"":o.YP` <svg id="bottom" width="${this._totalWidth}"> ${this._branches.map((e=>e.end?"":o.YP` <path class="${(0,h.$)({track:e.track})}" d="
                      M ${e.x} 0
                      V ${l}
                      L ${this._totalWidth/2} ${30}
                      "/> `))} </svg> `} `}},{kind:"get",static:!0,key:"styles",value:function(){return o.iv`:host{position:relative;display:flex;flex-direction:column;align-items:center}:host(:focus){outline:0}#branches{position:relative;display:flex;flex-direction:row;align-items:start}::slotted(*){z-index:1}::slotted([slot=head]){margin-bottom:calc(var(--hat-graph-branch-height)/ -2)}#lines{position:absolute}#top{height:var(--hat-graph-branch-height)}#bottom{height:calc(var(--hat-graph-branch-height) + var(--hat-graph-spacing))}path{stroke:var(--stroke-clr);stroke-width:2;fill:none}path.track{stroke:var(--track-clr)}:host([disabled]) path{stroke:var(--disabled-clr)}`}}]}}),o.oi),(0,i.Z)([(0,s.Mo)("hat-graph-node")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,s.Cb)()],key:"iconPath",value:void 0},{kind:"field",decorators:[(0,s.Cb)({reflect:!0,type:Boolean})],key:"disabled",value:void 0},{kind:"field",decorators:[(0,s.Cb)({reflect:!0,type:Boolean})],key:"notEnabled",value:()=>!1},{kind:"field",decorators:[(0,s.Cb)({reflect:!0,type:Boolean})],key:"graphStart",value:void 0},{kind:"field",decorators:[(0,s.Cb)({type:Boolean,attribute:"nofocus"})],key:"noFocus",value:()=>!1},{kind:"field",decorators:[(0,s.Cb)({reflect:!0,type:Number})],key:"badge",value:void 0},{kind:"method",key:"updated",value:function(e){e.has("noFocus")&&(this.hasAttribute("tabindex")||this.noFocus?void 0!==e.get("noFocus")&&this.noFocus&&this.removeAttribute("tabindex"):this.setAttribute("tabindex","0"))}},{kind:"method",key:"render",value:function(){const e=u+(this.graphStart?2:11);return o.dy` <svg width="${40}px" height="${e}px" viewBox="-${Math.ceil(20)} -${this.graphStart?Math.ceil(e/2):Math.ceil(25)} ${40} ${e}"> ${this.graphStart?"":o.YP` <path class="connector" d="
              M 0 ${-25}
              L 0 0
            " line-caps="round"/> `} <g class="node"> <circle cx="0" cy="0" r="${15}"/> } ${this.badge?o.YP` <g class="number"> <circle cx="8" cy="${-15}" r="8"></circle> <text x="8" y="${-15}" text-anchor="middle" alignment-baseline="middle">${this.badge>9?"9+":this.badge}</text> </g> `:""} <g style="pointer-events:none" transform="translate(${-12} ${-12})"> ${this.iconPath?o.YP`<path class="icon" d="${this.iconPath}/"></path>`:""} </g> </g> </svg> `}},{kind:"get",static:!0,key:"styles",value:function(){return o.iv`:host{display:flex;flex-direction:column;min-width:calc(var(--hat-graph-node-size) + var(--hat-graph-spacing));height:calc(var(--hat-graph-node-size) + var(--hat-graph-spacing) + 1px)}:host([graphStart]){height:calc(var(--hat-graph-node-size) + 2px)}:host([track]){--stroke-clr:var(--track-clr);--icon-clr:var(--default-icon-clr)}:host([active]) circle{--stroke-clr:var(--active-clr);--icon-clr:var(--default-icon-clr)}:host(:focus){outline:0}:host(:hover) circle{--stroke-clr:var(--hover-clr);--icon-clr:var(--default-icon-clr)}:host([notEnabled]) circle{--stroke-clr:var(--disabled-clr)}:host([notEnabled][active]) circle{--stroke-clr:var(--disabled-active-clr)}:host([notEnabled]:hover) circle{--stroke-clr:var(--disabled-hover-clr)}svg{width:100%;height:100%}circle,path.connector{stroke:var(--stroke-clr);stroke-width:2;fill:none}circle{fill:var(--background-clr);stroke:var(--circle-clr,var(--stroke-clr))}.number circle{fill:var(--track-clr);stroke:none;stroke-width:0}.number text{font-size:smaller}path.icon{fill:var(--icon-clr)}`}}]}}),o.oi),(0,i.Z)([(0,s.Mo)("hat-graph-spacer")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,s.Cb)({reflect:!0,type:Boolean})],key:"disabled",value:void 0},{kind:"method",key:"render",value:function(){return o.dy` <svg viewBox="-${5} 0 10 ${41}"> <path d="
              M 0 ${41}
              V 0
            " line-caps="round"/> } </svg> `}},{kind:"get",static:!0,key:"styles",value:function(){return o.iv`:host{display:flex;flex-direction:column;align-items:center}svg{width:var(--hat-graph-spacing);height:calc(var(--hat-graph-spacing) + var(--hat-graph-node-size) + 1px)}:host([track]){--stroke-clr:var(--track-clr)}:host-context([disabled]){--stroke-clr:var(--disabled-clr)}path{stroke:var(--stroke-clr);stroke-width:2;fill:none}`}}]}}),o.oi);(0,i.Z)([(0,s.Mo)("hat-script-graph")],(function(e,t){class r extends t{constructor(...t){super(...t),e(this)}}return{F:r,d:[{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"selected",value:void 0},{kind:"field",key:"renderedNodes",value:()=>({})},{kind:"field",key:"trackedNodes",value:()=>({})},{kind:"method",key:"selectNode",value:function(e,t){return()=>{(0,d.B)(this,"graph-node-selected",{config:e,path:t})}}},{kind:"method",key:"render_trigger",value:function(e,t){const r=`trigger/${t}`,i=this.trace&&r in this.trace.trace;return this.renderedNodes[r]={config:e,path:r},i&&(this.trackedNodes[r]=this.renderedNodes[r]),o.dy` <hat-graph-node graphStart ?track="${i}" @focus="${this.selectNode(e,r)}" ?active="${this.selected===r}" .iconPath="${"M21 13H14.4L19.1 17.7L17.7 19.1L13 14.4V21H11V14.3L6.3 19L4.9 17.6L9.4 13H3V11H9.6L4.9 6.3L6.3 4.9L11 9.6V3H13V9.4L17.6 4.8L19 6.3L14.3 11H21V13Z"}" .notEnabled="${!1===e.enabled}" tabindex="${i?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_condition",value:function(e,t){const r=`condition/${t}`;return this.renderedNodes[r]={config:e,path:r},this.trace&&r in this.trace.trace&&(this.trackedNodes[r]=this.renderedNodes[r]),this.render_condition_node(e,r)}},{kind:"field",key:"typeRenderers",value(){return{condition:this.render_condition_node,and:this.render_condition_node,or:this.render_condition_node,not:this.render_condition_node,delay:this.render_delay_node,event:this.render_event_node,scene:this.render_scene_node,service:this.render_service_node,wait_template:this.render_wait_node,wait_for_trigger:this.render_wait_node,repeat:this.render_repeat_node,choose:this.render_choose_node,device_id:this.render_device_node,if:this.render_if_node,stop:this.render_stop_node,parallel:this.render_parallel_node,other:this.render_other_node}}},{kind:"method",key:"render_action_node",value:function(e,t,r=!1,i=!1){const a=Object.keys(this.typeRenderers).find((t=>t in e))||"other";return this.renderedNodes[t]={config:e,path:t},this.trace&&t in this.trace.trace&&(this.trackedNodes[t]=this.renderedNodes[t]),this.typeRenderers[a].bind(this)(e,t,r,i)}},{kind:"method",key:"render_choose_node",value:function(e,t,r=!1,i=!1){var a,n;const s=this.trace.trace[t],d=s?s.map((e=>void 0===e.result||"default"===e.result.choice?"default":e.result.choice)):[],h=d.includes("default");return o.dy` <hat-graph-branch tabindex="${void 0===s?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${void 0!==s}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}"> <hat-graph-node .graphStart="${r}" .iconPath="${"M11,5H8L12,1L16,5H13V9.43C12.25,9.89 11.58,10.46 11,11.12V5M22,11L18,7V10C14.39,9.85 11.31,12.57 11,16.17C9.44,16.72 8.62,18.44 9.17,20C9.72,21.56 11.44,22.38 13,21.83C14.56,21.27 15.38,19.56 14.83,18C14.53,17.14 13.85,16.47 13,16.17C13.47,12.17 17.47,11.97 17.95,11.97V14.97L22,11M10.63,11.59C9.3,10.57 7.67,10 6,10V7L2,11L6,15V12C7.34,12.03 8.63,12.5 9.64,13.4C9.89,12.76 10.22,12.15 10.63,11.59Z"}" ?track="${void 0!==s}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" slot="head" nofocus></hat-graph-node> ${e.choose?null===(a=(0,c.r)(e.choose))||void 0===a?void 0:a.map(((r,a)=>{const n=`${t}/choose/${a}`,h=d.includes(a);return this.renderedNodes[n]={config:e,path:n},h&&(this.trackedNodes[n]=this.renderedNodes[n]),o.dy` <div class="graph-container" ?track="${h}"> <hat-graph-node .iconPath="${!s||h?"M19,19H5V5H15V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V11H19M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z":"M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z"}" @focus="${this.selectNode(e,n)}" ?track="${h}" ?active="${this.selected===n}" .notEnabled="${i||!1===e.enabled}"></hat-graph-node> ${null!==r.sequence?(0,c.r)(r.sequence).map(((t,r)=>this.render_action_node(t,`${n}/sequence/${r}`,!1,i||!1===e.enabled))):""} </div> `})):""} <div ?track="${h}"> <hat-graph-spacer ?track="${h}"></hat-graph-spacer> ${null!==e.default?null===(n=(0,c.r)(e.default))||void 0===n?void 0:n.map(((r,a)=>this.render_action_node(r,`${t}/default/${a}`,!1,i||!1===e.enabled))):""} </div> </hat-graph-branch> `}},{kind:"method",key:"render_if_node",value:function(e,t,r=!1,i=!1){const a=this.trace.trace[t];let n=!1,s=!1;for(const e of a||[]){var d,h;if(n||"then"!==(null===(d=e.result)||void 0===d?void 0:d.choice)||(n=!0),(s||"else"!==(null===(h=e.result)||void 0===h?void 0:h.choice))&&e.result||(s=!0),s&&n)break}return o.dy` <hat-graph-branch tabindex="${void 0===a?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${void 0!==a}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}"> <hat-graph-node .graphStart="${r}" .iconPath="${"M14,4L16.29,6.29L13.41,9.17L14.83,10.59L17.71,7.71L20,10V4M10,4H4V10L6.29,7.71L11,12.41V20H13V11.59L7.71,6.29"}" ?track="${void 0!==a}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" slot="head" nofocus></hat-graph-node> ${e.else?o.dy`<div class="graph-container" ?track="${s}"> <hat-graph-node .iconPath="${"M19.59,7L12,14.59L6.41,9H11V7H3V15H5V10.41L12,17.41L21,8.41"}" ?track="${s}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" nofocus></hat-graph-node>${(0,c.r)(e.else).map(((r,a)=>this.render_action_node(r,`${t}/else/${a}`,!1,i||!1===e.enabled)))} </div>`:o.dy`<hat-graph-spacer ?track="${s}"></hat-graph-spacer>`} <div class="graph-container" ?track="${n}"> <hat-graph-node .iconPath="${"M20,5.41L18.59,4L7,15.59V9H5V19H15V17H8.41"}" ?track="${n}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" nofocus></hat-graph-node> ${(0,c.r)(e.then).map(((r,a)=>this.render_action_node(r,`${t}/then/${a}`,!1,i||!1===e.enabled)))} </div> </hat-graph-branch> `}},{kind:"method",key:"render_condition_node",value:function(e,t,r=!1,i=!1){const a=this.trace.trace[t];let n=!1,s=!1,d=!1;if(a)for(const e of a)if(e.result&&(n=!0,e.result.result?s=!0:d=!0),s&&d)break;return o.dy` <hat-graph-branch @focus="${this.selectNode(e,t)}" ?track="${n}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" tabindex="${void 0===a?"-1":"0"}" short> <hat-graph-node .graphStart="${r}" slot="head" ?track="${n}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" .iconPath="${"M4 2A2 2 0 0 0 2 4V12H4V8H6V12H8V4A2 2 0 0 0 6 2H4M4 4H6V6H4M22 15.5V14A2 2 0 0 0 20 12H16V22H20A2 2 0 0 0 22 20V18.5A1.54 1.54 0 0 0 20.5 17A1.54 1.54 0 0 0 22 15.5M20 20H18V18H20V20M20 16H18V14H20M5.79 21.61L4.21 20.39L18.21 2.39L19.79 3.61Z"}" nofocus></hat-graph-node> <div style="${"width: 40px;"}" graphStart graphEnd></div> <div ?track="${s}"></div> <hat-graph-node .iconPath="${"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}" nofocus ?track="${d}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}"></hat-graph-node> </hat-graph-branch> `}},{kind:"method",key:"render_delay_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M12,20A7,7 0 0,1 5,13A7,7 0 0,1 12,6A7,7 0 0,1 19,13A7,7 0 0,1 12,20M19.03,7.39L20.45,5.97C20,5.46 19.55,5 19.04,4.56L17.62,6C16.07,4.74 14.12,4 12,4A9,9 0 0,0 3,13A9,9 0 0,0 12,22C17,22 21,17.97 21,13C21,10.88 20.26,8.93 19.03,7.39M11,14H13V8H11M15,1H9V3H15V1Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_device_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M3 6H21V4H3C1.9 4 1 4.9 1 6V18C1 19.1 1.9 20 3 20H7V18H3V6M13 12H9V13.78C8.39 14.33 8 15.11 8 16C8 16.89 8.39 17.67 9 18.22V20H13V18.22C13.61 17.67 14 16.88 14 16S13.61 14.33 13 13.78V12M11 17.5C10.17 17.5 9.5 16.83 9.5 16S10.17 14.5 11 14.5 12.5 15.17 12.5 16 11.83 17.5 11 17.5M22 8H16C15.5 8 15 8.5 15 9V19C15 19.5 15.5 20 16 20H22C22.5 20 23 19.5 23 19V9C23 8.5 22.5 8 22 8M21 18H17V10H21V18Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_event_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M10,9A1,1 0 0,1 11,8A1,1 0 0,1 12,9V13.47L13.21,13.6L18.15,15.79C18.68,16.03 19,16.56 19,17.14V21.5C18.97,22.32 18.32,22.97 17.5,23H11C10.62,23 10.26,22.85 10,22.57L5.1,18.37L5.84,17.6C6.03,17.39 6.3,17.28 6.58,17.28H6.8L10,19V9M11,5A4,4 0 0,1 15,9C15,10.5 14.2,11.77 13,12.46V11.24C13.61,10.69 14,9.89 14,9A3,3 0 0,0 11,6A3,3 0 0,0 8,9C8,9.89 8.39,10.69 9,11.24V12.46C7.8,11.77 7,10.5 7,9A4,4 0 0,1 11,5M11,3A6,6 0 0,1 17,9C17,10.7 16.29,12.23 15.16,13.33L14.16,12.88C15.28,11.96 16,10.56 16,9A5,5 0 0,0 11,4A5,5 0 0,0 6,9C6,11.05 7.23,12.81 9,13.58V14.66C6.67,13.83 5,11.61 5,9A6,6 0 0,1 11,3Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_repeat_node",value:function(e,t,r=!1,i=!1){var a,n;const s=this.trace.trace[t],d=null===(a=this.trace)||void 0===a||null===(n=a.trace[`${t}/repeat/sequence/0`])||void 0===n?void 0:n.length;return o.dy` <hat-graph-branch tabindex="${void 0===s?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}"> <hat-graph-node .graphStart="${r}" .iconPath="${"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" slot="head" nofocus></hat-graph-node> <hat-graph-node .iconPath="${"M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z"}" ?track="${d>1}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" nofocus .badge="${d>1?d:void 0}"></hat-graph-node> <div ?track="${s}"> ${(0,c.r)(e.repeat.sequence).map(((r,a)=>this.render_action_node(r,`${t}/repeat/sequence/${a}`,!1,i||!1===e.enabled)))} </div> </hat-graph-branch> `}},{kind:"method",key:"render_scene_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_service_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M12,5A2,2 0 0,1 14,7C14,7.24 13.96,7.47 13.88,7.69C17.95,8.5 21,11.91 21,16H3C3,11.91 6.05,8.5 10.12,7.69C10.04,7.47 10,7.24 10,7A2,2 0 0,1 12,5M22,19H2V17H22V19Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_wait_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M8,3A2,2 0 0,0 6,5V9A2,2 0 0,1 4,11H3V13H4A2,2 0 0,1 6,15V19A2,2 0 0,0 8,21H10V19H8V14A2,2 0 0,0 6,12A2,2 0 0,0 8,10V5H10V3M16,3A2,2 0 0,1 18,5V9A2,2 0 0,0 20,11H21V13H20A2,2 0 0,0 18,15V19A2,2 0 0,1 16,21H14V19H16V14A2,2 0 0,1 18,12A2,2 0 0,1 16,10V5H14V3H16Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_parallel_node",value:function(e,t,r=!1,i=!1){const a=this.trace.trace[t];return o.dy` <hat-graph-branch tabindex="${void 0===a?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}"> <hat-graph-node .graphStart="${r}" .iconPath="${"M16,4.5V7H5V9H16V11.5L19.5,8M16,12.5V15H5V17H16V19.5L19.5,16"}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}" slot="head" nofocus></hat-graph-node> ${(0,c.r)(e.parallel).map(((r,a)=>"sequence"in r?o.dy`<div ?track="${t in this.trace.trace}"> ${(0,c.r)(r.sequence).map(((r,n)=>this.render_action_node(r,`${t}/parallel/${a}/sequence/${n}`,!1,i||!1===e.enabled)))} </div>`:this.render_action_node(r,`${t}/parallel/${a}/sequence/0`,!1,i||!1===e.enabled)))} </hat-graph-branch> `}},{kind:"method",key:"render_stop_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M13 24C9.74 24 6.81 22 5.6 19L2.57 11.37C2.26 10.58 3 9.79 3.81 10.05L4.6 10.31C5.16 10.5 5.62 10.92 5.84 11.47L7.25 15H8V3.25C8 2.56 8.56 2 9.25 2S10.5 2.56 10.5 3.25V12H11.5V1.25C11.5 .56 12.06 0 12.75 0S14 .56 14 1.25V12H15V2.75C15 2.06 15.56 1.5 16.25 1.5C16.94 1.5 17.5 2.06 17.5 2.75V12H18.5V5.75C18.5 5.06 19.06 4.5 19.75 4.5S21 5.06 21 5.75V16C21 20.42 17.42 24 13 24Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}"></hat-graph-node> `}},{kind:"method",key:"render_other_node",value:function(e,t,r=!1,i=!1){return o.dy` <hat-graph-node .graphStart="${r}" .iconPath="${"M15,4V6H18V18H15V20H20V4M4,4V20H9V18H6V6H9V4H4Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${i||!1===e.enabled}"></hat-graph-node> `}},{kind:"method",key:"render",value:function(){const e=Object.keys(this.trackedNodes),t="trigger"in this.trace.config?(0,c.r)(this.trace.config.trigger).map(((e,t)=>this.render_trigger(e,t))):void 0;try{var r;return o.dy` <div class="parent graph-container"> ${t?o.dy`<hat-graph-branch start .short="${t.length<2}"> ${t} </hat-graph-branch>`:""} ${"condition"in this.trace.config?o.dy`${null===(r=(0,c.r)(this.trace.config.condition))||void 0===r?void 0:r.map(((e,t)=>this.render_condition(e,t)))}`:""} ${"action"in this.trace.config?o.dy`${(0,c.r)(this.trace.config.action).map(((e,t)=>this.render_action_node(e,`action/${t}`)))}`:""} ${"sequence"in this.trace.config?o.dy`${(0,c.r)(this.trace.config.sequence).map(((e,t)=>this.render_action_node(e,`sequence/${t}`,0===t)))}`:""} </div> <div class="actions"> <ha-icon-button .disabled="${0===e.length||e[0]===this.selected}" @click="${this._previousTrackedNode}" .path="${"M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"}"></ha-icon-button> <ha-icon-button .disabled="${0===e.length||e[e.length-1]===this.selected}" @click="${this._nextTrackedNode}" .path="${"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"}"></ha-icon-button> </div> `}catch(e){return o.dy` <div class="error"> Error rendering graph. Please download trace and share with the developers. </div> `}}},{kind:"method",key:"willUpdate",value:function(e){(0,a.Z)((0,n.Z)(r.prototype),"willUpdate",this).call(this,e),e.has("trace")&&(this.renderedNodes={},this.trackedNodes={})}},{kind:"method",key:"updated",value:function(e){if((0,a.Z)((0,n.Z)(r.prototype),"updated",this).call(this,e),e.has("trace")){if(!this.selected||!(this.selected in this.trackedNodes)){const e=this.trackedNodes[Object.keys(this.trackedNodes)[0]];e&&(0,d.B)(this,"graph-node-selected",e)}if(this.trace){const e=Object.keys(this.trace.trace),t=Object.keys(this.renderedNodes).sort(((t,r)=>e.indexOf(t)-e.indexOf(r))),r={},i={};for(const e of t)i[e]=this.renderedNodes[e],e in this.trackedNodes&&(r[e]=this.trackedNodes[e]);this.renderedNodes=i,this.trackedNodes=r}}}},{kind:"method",key:"_previousTrackedNode",value:function(){const e=Object.keys(this.trackedNodes),t=e.indexOf(this.selected)-1;t>=0&&(0,d.B)(this,"graph-node-selected",this.trackedNodes[e[t]])}},{kind:"method",key:"_nextTrackedNode",value:function(){const e=Object.keys(this.trackedNodes),t=e.indexOf(this.selected)+1;t<e.length&&(0,d.B)(this,"graph-node-selected",this.trackedNodes[e[t]])}},{kind:"get",static:!0,key:"styles",value:function(){return o.iv`:host{display:flex;--stroke-clr:var(--stroke-color, var(--secondary-text-color));--active-clr:var(--active-color, var(--primary-color));--track-clr:var(--track-color, var(--accent-color));--hover-clr:var(--hover-color, var(--primary-color));--disabled-clr:var(--disabled-color, var(--disabled-text-color));--disabled-active-clr:rgba(var(--rgb-primary-color), 0.5);--disabled-hover-clr:rgba(var(--rgb-primary-color), 0.7);--default-trigger-color:3,169,244;--rgb-trigger-color:var(--trigger-color, var(--default-trigger-color));--background-clr:var(--background-color, white);--default-icon-clr:var(--icon-color, black);--icon-clr:var(--stroke-clr);--hat-graph-spacing:${l}px;--hat-graph-node-size:${u}px;--hat-graph-branch-height:${20}px}.graph-container{display:flex;flex-direction:column;align-items:center}.actions{display:flex;flex-direction:column}.parent{margin-left:8px;margin-top:16px}.error{padding:16px;max-width:300px}`}}]}}),o.oi)},11777:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var i=r(17463),a=r(34541),n=r(47838),o=r(68144),s=r(79932),d=r(30153),c=r(44583),h=r(5435),l=r(47181),u=r(70518),v=r(74186),p=r(44547),k=r(31991),g=r(97389),b=(r(148),e([c,h,k]));[c,h,k]=b.then?(await b)():b;const f="M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",y="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",$="M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",m="M13,2.03V2.05L13,4.05C17.39,4.59 20.5,8.58 19.96,12.97C19.5,16.61 16.64,19.5 13,19.93V21.93C18.5,21.38 22.5,16.5 21.95,11C21.5,6.25 17.73,2.5 13,2.03M11,2.06C9.05,2.25 7.19,3 5.67,4.26L7.1,5.74C8.22,4.84 9.57,4.26 11,4.06V2.06M4.26,5.67C3,7.19 2.25,9.04 2.05,11H4.05C4.24,9.58 4.8,8.23 5.69,7.1L4.26,5.67M2.06,13C2.26,14.96 3.03,16.81 4.27,18.33L5.69,16.9C4.81,15.77 4.24,14.42 4.06,13H2.06M7.1,18.37L5.67,19.74C7.18,21 9.04,21.79 11,22V20C9.58,19.82 8.23,19.25 7.1,18.37M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z",_="M13,2.03V2.05L13,4.05C17.39,4.59 20.5,8.58 19.96,12.97C19.5,16.61 16.64,19.5 13,19.93V21.93C18.5,21.38 22.5,16.5 21.95,11C21.5,6.25 17.73,2.5 13,2.03M11,2.06C9.05,2.25 7.19,3 5.67,4.26L7.1,5.74C8.22,4.84 9.57,4.26 11,4.06V2.06M4.26,5.67C3,7.19 2.25,9.04 2.05,11H4.05C4.24,9.58 4.8,8.23 5.69,7.1L4.26,5.67M2.06,13C2.26,14.96 3.03,16.81 4.27,18.33L5.69,16.9C4.81,15.77 4.24,14.42 4.06,13H2.06M7.1,18.37L5.67,19.74C7.18,21 9.04,21.79 11,22V20C9.58,19.82 8.23,19.25 7.1,18.37M16.82,15.19L12.71,11.08C13.12,10.04 12.89,8.82 12.03,7.97C11.13,7.06 9.78,6.88 8.69,7.38L10.63,9.32L9.28,10.68L7.29,8.73C6.75,9.82 7,11.17 7.88,12.08C8.74,12.94 9.96,13.16 11,12.76L15.11,16.86C15.29,17.05 15.56,17.05 15.74,16.86L16.78,15.83C17,15.65 17,15.33 16.82,15.19Z",x="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z",C=2,L=1e3,V=(e,t)=>Math.abs(t.getTime()-e.getTime())>L;class w{constructor(e,t,r){this.hass=e,this.entries=t,this.lastReportedTime=void 0,this.lastReportedTime=new Date(r.timestamp.start)}setLastReportedTime(e){this.lastReportedTime=e}renderTime(e,t){this.entries.push(o.dy` <ha-timeline label> ${(0,h.G)(e,this.hass.locale,t,!1)} later </ha-timeline> `),this.lastReportedTime=t}maybeRenderTime(e){return V(e,this.lastReportedTime)?(this.renderTime(this.lastReportedTime,e),!0):(this.lastReportedTime=e,!1)}}class A{constructor(e,t,r){this.entries=e,this.timeTracker=t,this.logbookEntries=r,this.curIndex=void 0,this.pendingItems=[],this.curIndex=r.length>0&&"automation"===r[0].domain?1:0}get curItem(){return this.logbookEntries[this.curIndex]}get hasNext(){return this.curIndex<this.logbookEntries.length}maybeRenderItem(){const e=this.curItem;this.curIndex++;const t=new Date(1e3*e.when);if(0===this.pendingItems.length)return void this.pendingItems.push([t,e]);const r=this.pendingItems[this.pendingItems.length-1][0];V(r,t)&&(this._renderLogbookEntries(),this.timeTracker.renderTime(r,t)),this.pendingItems.push([t,e])}flush(){this.pendingItems.length>0&&this._renderLogbookEntries()}_renderLogbookEntries(){this.timeTracker.maybeRenderTime(this.pendingItems[0][0]);const e=[];let t,r;for(t=0;t<Math.min(this.pendingItems.length,C);t++)e.push(this._renderLogbookEntryHelper(this.pendingItems[t][1]));if(t<this.pendingItems.length)for(r=[];t<this.pendingItems.length;t++)r.push(this._renderLogbookEntryHelper(this.pendingItems[t][1]));this.entries.push(o.dy` <ha-timeline .icon="${$}" .moreItems="${r}"> ${e} </ha-timeline> `),this.timeTracker.setLastReportedTime(this.pendingItems[this.pendingItems.length-1][0]),this.pendingItems=[]}_renderLogbookEntryHelper(e){return o.dy`${e.name} (${e.entity_id}) ${e.message||`turned ${e.state}`}<br>`}}class H{constructor(e,t,r,i,a,n){this.hass=e,this.entityReg=t,this.entries=r,this.trace=i,this.logbookRenderer=a,this.timeTracker=n,this.curIndex=0,this.keys=void 0,this.keys=Object.keys(i.trace)}get curItem(){return this._getItem(this.curIndex)}get hasNext(){return this.curIndex<this.keys.length}renderItem(){this.curIndex=this._renderItem(this.curIndex)}_getItem(e){return this.trace.trace[this.keys[e]]}_renderItem(e,t,r){const i=this._getItem(e);if(r){let r;return i.forEach((i=>{r=this._renderIteration(e,i,t)})),r}return this._renderIteration(e,i[0],t)}_renderIteration(e,t,r){if((0,g.Zm)(t.path))return this._handleTrigger(e,t);const i=new Date(t.timestamp);for(;this.logbookRenderer.hasNext&&new Date(1e3*this.logbookRenderer.curItem.when)<i;)this.logbookRenderer.maybeRenderItem();this.logbookRenderer.flush(),this.timeTracker.maybeRenderTime(i);const a=t.path;let n;try{n=(0,g.nV)(this.trace.config,a)}catch(t){return this._renderEntry(a,`Unable to extract path ${a}. Download trace and report as bug`),e+1}const o=a.split("/");if(!(2===o.length)&&!r)return this._renderEntry(a,a.replace(/\//g," ")),e+1;if(r||(r=(0,p.Pw)(n)),"choose"===r)return this._handleChoose(e);if("repeat"===r)return this._handleRepeat(e);if("if"===r)return this._handleIf(e);if("parallel"===r)return this._handleParallel(e);this._renderEntry(a,(0,k.Q)(this.hass,this.entityReg,n,r),void 0,!1===n.enabled);let s=e+1;for(;s<this.keys.length&&this.keys[s].split("/").length!==o.length;s++);return s}_handleTrigger(e,t){return this._renderEntry(t.path,`${t.changed_variables.trigger.alias?`${t.changed_variables.trigger.alias} triggered`:"Triggered"} ${"trigger"===t.path?"manually":`by the ${this.trace.trigger}`} at\n    ${(0,c.E8)(new Date(t.timestamp),this.hass.locale,this.hass.config)}`,y),e+1}_handleChoose(e){var t;const r=this.keys[e],i=r.split("/").length,a=this._getItem(e)[0],n="default"===(null===(t=a.result)||void 0===t?void 0:t.choice),o=this._getDataFromPath(this.keys[e]),s=!1===o.enabled,d=o.alias||"Choose";if(n)this._renderEntry(r,`${d}: Default action executed`,void 0,s);else if(a.result){const t="default"!==a.result.choice?a.result.choice+1:void 0,i=this._getDataFromPath(`${this.keys[e]}/choose/${a.result.choice}`),n=i?`${i.alias||`Option ${t}`} executed`:`Error: ${a.error}`;this._renderEntry(r,`${d}: ${n}`,void 0,s)}else this._renderEntry(r,`${d}: No action taken`,void 0,s);let c;for(c=e+1;c<this.keys.length;c++){const e=this.keys[c].split("/");if(e.length<=i)return c;if(n&&"default"===e[i+1]||!n&&"sequence"===e[i+3])break}for(;c<this.keys.length;){const e=this.keys[c];if(e.split("/").length<=i)return c;c=this._renderItem(c,(0,p.Pw)(this._getDataFromPath(e)))}return c}_handleRepeat(e){const t=this.keys[e],r=t.split("/").length,i=this._getDataFromPath(this.keys[e]),a=!1===i.enabled,n=i.alias||(0,k.Q)(this.hass,this.entityReg,i);let o;for(this._renderEntry(t,n,void 0,a),o=e+1;o<this.keys.length;o++){const e=this.keys[o];if(e.split("/").length<=r)return o;o=this._renderItem(o,(0,p.Pw)(this._getDataFromPath(e)),!0)}return o}_handleIf(e){var t;const r=this.keys[e],i=r.split("/").length,a=this._getItem(e)[0],n=this._getDataFromPath(this.keys[e]),o=!1===n.enabled,s=n.alias||"If";if(null!==(t=a.result)&&void 0!==t&&t.choice){const t=this._getDataFromPath(`${this.keys[e]}/${a.result.choice}/`),i=t?`${t.alias||`${a.result.choice} action executed`}`:`Error: ${a.error}`;this._renderEntry(r,`${s}: ${i}`,void 0,o)}else this._renderEntry(r,`${s}: No action taken`,void 0,o);let d;for(d=e+1;d<this.keys.length;d++){const e=this.keys[d],t=this.keys[d].split("/");if(t.length<=i)return d;"condition"===t[i+1]||t.length<i+2||(d=this._renderItem(d,(0,p.Pw)(this._getDataFromPath(e))))}return d}_handleParallel(e){const t=this.keys[e],r=t.split("/").length,i=this._getDataFromPath(this.keys[e]),a=!1===i.enabled,n=i.alias||"Execute in parallel";let o;for(this._renderEntry(t,n,void 0,a),o=e+1;o<this.keys.length;o++){const e=this.keys[o];if(e.split("/").length<=r)return o;o=this._renderItem(o,(0,p.Pw)(this._getDataFromPath(e)))}return o}_renderEntry(e,t,r=x,i=!1){this.entries.push(o.dy` <ha-timeline .icon="${r}" data-path="${e}" .notEnabled="${i}"> ${t}${i?o.dy`<span class="disabled"> (disabled)</span>`:""} </ha-timeline> `)}_getDataFromPath(e){return(0,g.nV)(this.trace.config,e)}}(0,i.Z)([(0,s.Mo)("hat-trace-timeline")],(function(e,t){class r extends t{constructor(...t){super(...t),e(this)}}return{F:r,d:[{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"selectedPath",value:void 0},{kind:"field",decorators:[(0,s.Cb)({type:Boolean})],key:"allowPick",value:()=>!1},{kind:"field",decorators:[(0,s.SB)()],key:"_entityReg",value:()=>[]},{kind:"method",key:"hassSubscribe",value:function(){return[(0,v.LM)(this.hass.connection,(e=>{this._entityReg=e}))]}},{kind:"method",key:"render",value:function(){if(!this.trace)return o.Ld;const e=[],t=new w(this.hass,e,this.trace),r=new A(e,t,this.logbookEntries||[]),i=new H(this.hass,this._entityReg,e,this.trace,r,t);for(;i.hasNext;)i.renderItem();for(;r.hasNext;)r.maybeRenderItem();r.flush();const a=()=>(0,c.E8)(new Date(this.trace.timestamp.finish),this.hass.locale,this.hass.config),n=()=>`(runtime:\n      ${((new Date(this.trace.timestamp.finish).getTime()-new Date(this.trace.timestamp.start).getTime())/1e3).toFixed(2)}\n      seconds)`;let s;if("running"===this.trace.state)s={description:"Still running",icon:m};else if("debugged"===this.trace.state)s={description:"Debugged",icon:_};else if("finished"===this.trace.script_execution)s={description:`Finished at ${a()} ${n()}`,icon:y};else if("aborted"===this.trace.script_execution)s={description:`Aborted at ${a()} ${n()}`,icon:f};else if("cancelled"===this.trace.script_execution)s={description:`Cancelled at ${a()} ${n()}`,icon:f};else{let e,t,r=!1;switch(this.trace.script_execution){case"failed_conditions":e="a condition failed";break;case"failed_single":e="only a single execution is allowed";break;case"failed_max_runs":e="maximum number of parallel runs reached";break;case"error":e="an error was encountered",r=!0,t=o.dy`<br><br>${this.trace.error}`;break;default:e=`of unknown reason "${this.trace.script_execution}"`,r=!0}s={description:o.dy`Stopped because ${e} at ${a()} ${n()}${t||""}`,icon:f,className:r?"error":void 0}}return e.push(o.dy` <ha-timeline lastItem .icon="${s.icon}" class="${(0,d.o)(s.className)}"> ${s.description} </ha-timeline> `),o.dy`${e}`}},{kind:"method",key:"updated",value:function(e){if((0,a.Z)((0,n.Z)(r.prototype),"updated",this).call(this,e),this.allowPick&&e.has("trace")&&this.trace&&this.selectedPath&&!(this.selectedPath in this.trace.trace)){const e=this.shadowRoot.querySelector("ha-timeline[data-path]");e&&((0,l.B)(this,"value-changed",{value:e.dataset.path}),this.selectedPath=e.dataset.path)}(e.has("trace")||e.has("selectedPath"))&&this.shadowRoot.querySelectorAll("ha-timeline[data-path]").forEach((e=>{if((0,u.X)(e,"selected",this.selectedPath===e.dataset.path),!this.allowPick||0===e.tabIndex)return;e.tabIndex=0;const t=()=>{this.selectedPath=e.dataset.path,(0,l.B)(this,"value-changed",{value:e.dataset.path})};e.addEventListener("click",t),e.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||t()})),e.addEventListener("mouseover",(()=>{e.raised=!0})),e.addEventListener("mouseout",(()=>{e.raised=!1}))}))}},{kind:"get",static:!0,key:"styles",value:function(){return[o.iv`ha-timeline[lastItem].condition{--timeline-ball-color:var(--error-color)}ha-timeline[data-path]{cursor:pointer}ha-timeline[selected]{--timeline-ball-color:var(--primary-color)}ha-timeline:focus{outline:0;--timeline-ball-color:var(--accent-color)}.error{--timeline-ball-color:var(--error-color);color:var(--error-color)}`]}}]}}),o.oi);t()}catch(e){t(e)}}))},19476:(e,t,r)=>{r.d(t,{b:()=>i});const i=r(68144).iv`.tabs{background-color:var(--primary-background-color);border-top:1px solid var(--divider-color);border-bottom:1px solid var(--divider-color);display:flex;padding-left:4px}.tabs.top{border-top:none}.tabs>*{padding:2px 16px;cursor:pointer;position:relative;bottom:-1px;border:none;border-bottom:2px solid transparent;user-select:none;background:0 0;color:var(--primary-text-color);outline:0;transition:background 15ms linear}.tabs>.active{border-bottom-color:var(--primary-color)}.tabs>:focus,.tabs>:hover{background:var(--secondary-background-color)}`}};
//# sourceMappingURL=12740-7DsIypfatyk.js.map